<?php

header("Access-Control-Allow-Origin: *");
	
class Logout_model extends CI_Model{
	public function logout(){

		session_start();
	
		$email=$_SESSION["email"];
		$login_t=$_SESSION["login_time"];
	
		$servername = "localhost";
		$username = "root";
		$password = "jaisairam";
		$dbname = "100acres";

		/// Create connection
		$conn = new mysqli($servername, $username, $password, $dbname);
		// Check connection
		if ($conn->connect_error) {
		    die("Connection failed: " . $conn->connect_error);
		}

		$sql="INSERT INTO session_details (email,login_time,logout_time) VALUES('$email','$login_t',NOW()) ON DUPLICATE KEY UPDATE login_time=VALUES(login_time), logout_time=VALUES(logout_time)";

		if ($conn->query($sql) === TRUE) {
		    echo "Logged out successfully!!";
		} else {
		    echo "Error: " . $sql . "<br>" . $conn->error;
		}
		$conn->close();
		// remove all session variables
		session_unset(); 

		// destroy the session 
		session_destroy(); 
	}
}


?>
